<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>netcoreapp3.1</TargetFramework>
  </PropertyGroup>

  <Target Name="MyPreCompileTarget" BeforeTargets="Build">    
    <Exec Command="dotnet tool install -g Wyam.Tool" ContinueOnError="true"  Condition=" '$(OS)' != 'Windows_NT' " />
        
    <Exec Command="wyam -c $(ProjectDir)WyamBlog\config.wyam -i $(ProjectDir)WyamBlog\input\ -o $(ProjectDir)Wyam\" Condition="'$(OS)' == 'Windows_NT'"/>
    <Exec Command="ls /github/home/.dotnet/tools/" Condition=" '$(OS)' != 'Windows_NT' " />
    <Exec Command="/github/home/.dotnet/tools/wyam -c $(ProjectDir)WyamBlog/config.wyam -i $(ProjectDir)WyamBlog/input/ -o $(ProjectDir)Wyam/" Condition=" '$(OS)' != 'Windows_NT' " />

    <Exec Command="echo WYAM BUILD COMPLETE" />
    
    <Exec Command="copy $(ProjectDir)Wyam\index.html $(ProjectDir)wwwroot\index.html" Condition="'$(OS)' == 'Windows_NT'" />
    <Exec Command="cp $(ProjectDir)Wyam/index.html $(ProjectDir)wwwroot/index.html" Condition="'$(OS)' != 'Windows_NT'" />
    
    <Exec Command="echo WYAM INDEX COPY COMPLETE " />
  </Target>

  <Target Name="MyPostCompileTarget" AfterTargets="Publish">  
    <Exec Command="echo COPYING WYAM FILES" />
    <Exec Command="xcopy /Y /I /S $(ProjectDir)Wyam $(ProjectDir)$(PublishDir)Wyam" Condition="'$(OS)' == 'Windows_NT'" />
    <Exec Command="cp -r $(ProjectDir)Wyam $(ProjectDir)$(PublishDir)Wyam" Condition="'$(OS)' != 'Windows_NT'" />    
    <Exec Command="echo COPYING WYAM FILES COMPLETE" />
  </Target>

  <ItemGroup>
    <Compile Remove="WyamBlog\**" />
    <Content Remove="WyamBlog\**" />
    <EmbeddedResource Remove="WyamBlog\**" />
    <None Remove="WyamBlog\**" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="Wyam" Version="2.2.9" />
  </ItemGroup>

</Project>
